/*drop table if exists tmp_viitenr;
create table if not EXISTS tmp_viitenr_lisa (ik text, asutus text, vn text);

insert into  tmp_viitenr_lisa (ik, asutus, vn)
SELECT
    t.f[1]::text AS ik
        ,t.f[2]::text AS asutus
        ,t.f[3]::text AS vn
FROM (
         SELECT regexp_split_to_array(l, ';') AS f
         FROM regexp_split_to_table(
                      $$49511183730;0911027 Narva Lasteaed Pongerjas T;27012
47811080270;0911027 Narva Lasteaed Pongerjas T;27025
49107072255;0911027 Narva Lasteaed Pongerjas T;27038
48111242238;0911027 Narva Lasteaed Pongerjas T;27999
50911303714;0951004 Narva Muusikakool T;8100216
50710303714;0951004 Narva Muusikakool T;8100313
51705230140;0951004 Narva Muusikakool T;8100915
61608240095;0951004 Narva Muusikakool T;8101011
50912163716;0951004 Narva Muusikakool T;8102117
60307113751;0951004 Narva Muusikakool T;8102311
60202193735;0951002 Narva Kunstikool T;8200611
60609143736;0951002 Narva Kunstikool T;8200912
50501183714;0951002 Narva Kunstikool T;8201212
60607013732;0951002 Narva Kunstikool T;8201610
60709027076;0951002 Narva Kunstikool T;8201911
60511013736;0951002 Narva Kunstikool T;8202017
61402240048;0951002 Narva Kunstikool T;8202318
61311040010;0951002 Narva Kunstikool T;8204510
61301290020;0951002 Narva Kunstikool T;8206916
61303250068;0951002 Narva Kunstikool T;8207119
61209290111;0951002 Narva Kunstikool T;8208312
61301140198;0951002 Narva Kunstikool T;8208613
51110060078;0951002 Narva Kunstikool T;8209214
61002073711;0951002 Narva Kunstikool T;8209418
60612053717;0951002 Narva Kunstikool T;8209515
60905253727;0951002 Narva Kunstikool T;8209719
61006293735;0951002 Narva Kunstikool T;8209816
51204283712;0951002 Narva Kunstikool T;8212913
61112083725;0951002 Narva Kunstikool T;8214911
61202283758;0951002 Narva Kunstikool T;8215017
51109133748;0951002 Narva Kunstikool T;8215211
61108250119;0951002 Narva Kunstikool T;8215716
61012213735;0951002 Narva Kunstikool T;8215910
61012213740;0951002 Narva Kunstikool T;8216113
50911303714;0951002 Narva Kunstikool T;8216210
61202173712;0951002 Narva Kunstikool T;8216317
61311130151;0951002 Narva Kunstikool T;8218315
51409020078;0951002 Narva Kunstikool T;8222615
61412230110;0951002 Narva Kunstikool T;8222712
61412230108;0951002 Narva Kunstikool T;8223517
61403280070;0951002 Narva Kunstikool T;8223614
51405130060;0951002 Narva Kunstikool T;8224215
51407180279;0951002 Narva Kunstikool T;8225117
51509020353;0951002 Narva Kunstikool T;8226213
61404140147;0951002 Narva Kunstikool T;8228512
61504210116;0951002 Narva Kunstikool T;8228910
61307300135;0951002 Narva Kunstikool T;8230212
61508100156;0951002 Narva Kunstikool T;8232113
50212043719;0951004 Narva Muusikakool T;8411015
49606010066;0951004 Narva Muusikakool T;8411413
50407313710;0951004 Narva Muusikakool T;8412713
61502220059;0951004 Narva Muusikakool T;8412917
51612090047;0951004 Narva Muusikakool T;8413217
61512120057;0951004 Narva Muusikakool T;8413819
61705220074;0951004 Narva Muusikakool T;8414119
50401143711;0951004 Narva Muusikakool T;8414614
51102263729;0951004 Narva Muusikakool T;8414818
51210050150;0951004 Narva Muusikakool T;8415011
51407070021;0951004 Narva Muusikakool T;8415817
60706293710;0951004 Narva Muusikakool T;8416010
50609223727;0951004 Narva Muusikakool T;8418115
51309020064;0951004 Narva Muusikakool T;8418513
60710153727;0951004 Narva Muusikakool T;8418814
51506280217;0951004 Narva Muusikakool T;8419017
61507040053;0951004 Narva Muusikakool T;8419716
50710083730;0951004 Narva Muusikakool T;8420213
61405290174;0951004 Narva Muusikakool T;8420611
60509053712;0951004 Narva Muusikakool T;8420912
51109303717;0951004 Narva Muusikakool T;8421115
61605200085;0951004 Narva Muusikakool T;8421319
60712143730;0951004 Narva Muusikakool T;8422415
61411140096;0951004 Narva Muusikakool T;8422619
60611183728;0951004 Narva Muusikakool T;8422910
61603070086;0951004 Narva Muusikakool T;8423414
61604160115;0951004 Narva Muusikakool T;8424316
61405190037;0951004 Narva Muusikakool T;8424617
61502270126;0951004 Narva Muusikakool T;8425218
51608150258;0951004 Narva Muusikakool T;8426110
50501103752;0951004 Narva Muusikakool T;8426411
51710110045;0951004 Narva Muusikakool T;8429214
60611073715;0951004 Narva Muusikakool T;8430012
61410100074;0951004 Narva Muusikakool T;8430313
50708253713;0951004 Narva Muusikakool T;8432311
60705253710;0951004 Narva Muusikakool T;8433213
60510083725;0951004 Narva Muusikakool T;8433514
61503300219;0951004 Narva Muusikakool T;8434513
60609270020;0951004 Narva Muusikakool T;8436210
60705303736;0951004 Narva Muusikakool T;8437112
61606210140;0951004 Narva Muusikakool T;8438315
61706280094;0951004 Narva Muusikakool T;8438917
50508063713;0951004 Narva Muusikakool T;8439110
61106163744;0951004 Narva Muusikakool T;8439518
60804223720;0951004 Narva Muusikakool T;8439712
50609273718;0951004 Narva Muusikakool T;8441713
61310040180;0951004 Narva Muusikakool T;8442013
50709182758;0951004 Narva Muusikakool T;8442411
61711050062;0951004 Narva Muusikakool T;8443313
60507303718;0951004 Narva Muusikakool T;8443711
61710080034;0951004 Narva Muusikakool T;8444613
61401080244;0951004 Narva Muusikakool T;8445418
51702150166;0951004 Narva Muusikakool T;8446310
61801010033;0951004 Narva Muusikakool T;8446815
51711220030;0951004 Narva Muusikakool T;8448415
51005073725;0951004 Narva Muusikakool T;8449919
51007233722;0951004 Narva Muusikakool T;8451716
61602190115;0951004 Narva Muusikakool T;8452414
51407100245;0951004 Narva Muusikakool T;8453219
61712240050;0951004 Narva Muusikakool T;8454014
61405300074;0951004 Narva Muusikakool T;8454218
50810203711;0951004 Narva Muusikakool T;8456517
60510022741;0951004 Narva Muusikakool T;8456711
60906287099;0951004 Narva Muusikakool T;8458719
51306020169;0951004 Narva Muusikakool T;8459310
60607313745;0951004 Narva Muusikakool T;8459611
61403210043;0951004 Narva Muusikakool T;8459912
61408140192;0951004 Narva Muusikakool T;8460118
60607117116;0951004 Narva Muusikakool T;8461010
61702240100;0951004 Narva Muusikakool T;8463513
60401283735;0951004 Narva Muusikakool T;8464114
51402160186;0951004 Narva Muusikakool T;8464619
60411063724;0951004 Narva Muusikakool T;8465113
60411063724;0951004 Narva Muusikakool T;8465812
49807183710;0951004 Narva Muusikakool T;8466714
61702040165;0951004 Narva Muusikakool T;8467014
60511080868;0951004 Narva Muusikakool T;8468013
60307053740;0951004 Narva Muusikakool T;8469614
61202173712;0951004 Narva Muusikakool T;8470111
60609033712;0951004 Narva Muusikakool T;8470412
61011243712;0951004 Narva Muusikakool T;8474719
50703173718;0951004 Narva Muusikakool T;8476115
61010133716;0951004 Narva Muusikakool T;8480619
49810283729;0951004 Narva Muusikakool T;8481210
61406300122;0951004 Narva Muusikakool T;8481511
51606010018;0951004 Narva Muusikakool T;8485313
51602150098;0951004 Narva Muusikakool T;8489717
50510143724;0951004 Narva Muusikakool T;8490214
50604083732;0951004 Narva Muusikakool T;8490515
51706090033;0951004 Narva Muusikakool T;8492018
61512280137;0951004 Narva Muusikakool T;8495219
51710050143;0951004 Narva Muusikakool T;8495617
61307020077;0951004 Narva Muusikakool T;8495811
50501103752;0951004 Narva Muusikakool T;8496014
60611073715;0951004 Narva Muusikakool T;8496218
51409050131;0951004 Narva Muusikakool T;8496519
50807053710;0810203 Narva Paemurru Spordikool T;8500081
60801303730;0810203 Narva Paemurru Spordikool T;8500117
60902113711;0810203 Narva Paemurru Spordikool T;8500120
50810123719;0810203 Narva Paemurru Spordikool T;8500162
60808073719;0810203 Narva Paemurru Spordikool T;8500191
60407163734;0810203 Narva Paemurru Spordikool T;8500272
60602080307;0810203 Narva Paemurru Spordikool T;8500285
60511073712;0810203 Narva Paemurru Spordikool T;8500324
61604040052;0810203 Narva Paemurru Spordikool T;8500353
61504250086;0810203 Narva Paemurru Spordikool T;8500366
61504180039;0810203 Narva Paemurru Spordikool T;8500379
61103022742;0810203 Narva Paemurru Spordikool T;8500395
61103233714;0810203 Narva Paemurru Spordikool T;8500418
60909063712;0810203 Narva Paemurru Spordikool T;8500447
61107063710;0810203 Narva Paemurru Spordikool T;8500502
60804143717;0810203 Narva Paemurru Spordikool T;8500531
61004193719;0810203 Narva Paemurru Spordikool T;8500573
50812193712;0810203 Narva Paemurru Spordikool T;8500683
51301220047;0810203 Narva Paemurru Spordikool T;8500764
61306200070;0810203 Narva Paemurru Spordikool T;8509354
51603160186;0810203 Narva Paemurru Spordikool T;8510660
61506090050;0810203 Narva Paemurru Spordikool T;8510961
39607113717;0810203 Narva Paemurru Spordikool T;8511436
99927122000;0810203 Narva Paemurru Spordikool T;8514048
99901081998;0810203 Narva Paemurru Spordikool T;8515458
60510083725;0810203 Narva Paemurru Spordikool T;8515542
61309270133;0810203 Narva Paemurru Spordikool T;8515555
51305220187;0810203 Narva Paemurru Spordikool T;8518196
99918042003;0810203 Narva Paemurru Spordikool T;8518471
51609030112;0810203 Narva Paemurru Spordikool T;8525082
51608080033;0810203 Narva Paemurru Spordikool T;8525118
51704080136;0810203 Narva Paemurru Spordikool T;8526256
51506090180;0810203 Narva Paemurru Spordikool T;8528005
60604167016;0810203 Narva Paemurru Spordikool T;8529457
61512250105;0810203 Narva Paemurru Spordikool T;8529910
61411220142;0810203 Narva Paemurru Spordikool T;8531937
50805023712;0810203 Narva Paemurru Spordikool T;8533605
61101193718;0810203 Narva Paemurru Spordikool T;8533906
51204233710;0810203 Narva Paemurru Spordikool T;8534426
50403233753;0810203 Narva Paemurru Spordikool T;8537591
61203093725;0810203 Narva Paemurru Spordikool T;8539997
61307240037;0810203 Narva Paemurru Spordikool T;8545693
61410150076;0810203 Narva Paemurru Spordikool T;8555599
61104193744;0810203 Narva Paemurru Spordikool T;8558253
60610093713;0810203 Narva Paemurru Spordikool T;8561949
60702230015;0810203 Narva Paemurru Spordikool T;8563141
61102093717;0810203 Narva Paemurru Spordikool T;8585048
61401010108;0810203 Narva Paemurru Spordikool T;8590075
51307190124;0810203 Narva Paemurru Spordikool T;8590266
51201193712;0810203 Narva Paemurru Spordikool T;8590761
50802203717;0810203 Narva Paemurru Spordikool T;8590839
51302030014;0810203 Narva Paemurru Spordikool T;8590965
50604273726;0810204 Narva Spordikool Energia T;8600392
51002163715;0810204 Narva Spordikool Energia T;8610175
51308290250;0810204 Narva Spordikool Energia T;8620275
51112050081;0810204 Narva Spordikool Energia T;8625089
50902203710;0810204 Narva Spordikool Energia T;8641872
51203233727;0810204 Narva Spordikool Energia T;8649379
51408090078;0810204 Narva Spordikool Energia T;8662563
50708303717;0810204 Narva Spordikool Energia T;8679132
50507063721;0810204 Narva Spordikool Energia T;8694489
51103213710;0951006 Narva Noorte Meremeeste Klubi T;8700713
50712190032;0951006 Narva Noorte Meremeeste Klubi T;8701615
50301193732;0951006 Narva Noorte Meremeeste Klubi T;8710910
50106253729;0951006 Narva Noorte Meremeeste Klubi T;8711715
50707203728;0951006 Narva Noorte Meremeeste Klubi T;8711919
51207022720;0951006 Narva Noorte Meremeeste Klubi T;8713218
61103173714;0951006 Narva Noorte Meremeeste Klubi T;8713519
50809043713;0951006 Narva Noorte Meremeeste Klubi T;8715711
51010033716;0951006 Narva Noorte Meremeeste Klubi T;8720418
50903023716;0951006 Narva Noorte Meremeeste Klubi T;8720719
50711123710;0951006 Narva Noorte Meremeeste Klubi T;8721417
50709182758;0951006 Narva Noorte Meremeeste Klubi T;8722319
50508183755;0951006 Narva Noorte Meremeeste Klubi T;8723716
60705253721;0951006 Narva Noorte Meremeeste Klubi T;8727110
51308140111;0951006 Narva Noorte Meremeeste Klubi T;8727314
61209103731;0951006 Narva Noorte Meremeeste Klubi T;8732011
51112123765;0951006 Narva Noorte Meremeeste Klubi T;8732419
51308010150;0951006 Narva Noorte Meremeeste Klubi T;8732710
50910053715;0951006 Narva Noorte Meremeeste Klubi T;8733117
47003213729;0820201 Kultuurimaja Rugodiv T;8801719
61009173719;0820201 Kultuurimaja Rugodiv T;8802417
60505053725;0820201 Kultuurimaja Rugodiv T;8802514
61308040183;0820201 Kultuurimaja Rugodiv T;8802815
61512290068;0820201 Kultuurimaja Rugodiv T;8803319
61009293728;0820201 Kultuurimaja Rugodiv T;8803814
51612040108;0820201 Kultuurimaja Rugodiv T;8804211
46911043713;0820201 Kultuurimaja Rugodiv T;8805618
61602040140;0820201 Kultuurimaja Rugodiv T;8805715
61803070139;0820201 Kultuurimaja Rugodiv T;8805919
61712090084;0820201 Kultuurimaja Rugodiv T;8807616
61004140034;0820201 Kultuurimaja Rugodiv T;8808217
60910063745;0820201 Kultuurimaja Rugodiv T;8808615
61112143714;0820201 Kultuurimaja Rugodiv T;8809119
50504140028;0820201 Kultuurimaja Rugodiv T;8809711
61207020096;0820201 Kultuurimaja Rugodiv T;8810014
46710200001;0820201 Kultuurimaja Rugodiv T;8810111
47001043739;0820201 Kultuurimaja Rugodiv T;8810315
60508293714;0820201 Kultuurimaja Rugodiv T;8810519
51607230191;0820201 Kultuurimaja Rugodiv T;8811411
61711050062;0820201 Kultuurimaja Rugodiv T;8811712
51806220217;0820201 Kultuurimaja Rugodiv T;8812012
61506150039;0820201 Kultuurimaja Rugodiv T;8812119
51608050012;0820201 Kultuurimaja Rugodiv T;8812818
61805030067;0820201 Kultuurimaja Rugodiv T;8813312
51711040121;0820201 Kultuurimaja Rugodiv T;8813419
60609053748;0820201 Kultuurimaja Rugodiv T;8813613
60408073740;0820201 Kultuurimaja Rugodiv T;8813817
61110043720;0820201 Kultuurimaja Rugodiv T;8814214
61207163719;0820201 Kultuurimaja Rugodiv T;8816115
61803220214;0820201 Kultuurimaja Rugodiv T;8816513
61509180140;0820201 Kultuurimaja Rugodiv T;8817512
47309143728;0820201 Kultuurimaja Rugodiv T;8818016
60801160235;0820201 Kultuurimaja Rugodiv T;8819413
61705070037;0820201 Kultuurimaja Rugodiv T;8819510
47501273710;0820201 Kultuurimaja Rugodiv T;8819918
61710110079;0820201 Kultuurimaja Rugodiv T;8820114
35208223729;0820201 Kultuurimaja Rugodiv T;8822219
61411200030;0820201 Kultuurimaja Rugodiv T;8822413
61603130057;0820201 Kultuurimaja Rugodiv T;8824217
61002083729;0820201 Kultuurimaja Rugodiv T;8825517
60912253727;0820201 Kultuurimaja Rugodiv T;8826215
61107273729;0820201 Kultuurimaja Rugodiv T;8826613
61804120126;0820201 Kultuurimaja Rugodiv T;8826914
61709090234;0820201 Kultuurimaja Rugodiv T;8827117
61605180025;0820201 Kultuurimaja Rugodiv T;8829717
61507210044;0820201 Kultuurimaja Rugodiv T;8830816
51606300127;0820201 Kultuurimaja Rugodiv T;8832319
61209260276;0820201 Kultuurimaja Rugodiv T;8836519
61010133716;0820201 Kultuurimaja Rugodiv T;8837411
61702240100;0820201 Kultuurimaja Rugodiv T;8838313
51512160029;0820201 Kultuurimaja Rugodiv T;8838517
60510022741;0820201 Kultuurimaja Rugodiv T;8842613
61710270061;0820201 Kultuurimaja Rugodiv T;8849917
51602100128;0820201 Kultuurimaja Rugodiv T;8851617
61609220075;0820201 Kultuurimaja Rugodiv T;8853916
61411030104;0820201 Kultuurimaja Rugodiv T;8854119
51703080120;0820201 Kultuurimaja Rugodiv T;8856117
61708050114;0820201 Kultuurimaja Rugodiv T;8856816
61601150268;0820201 Kultuurimaja Rugodiv T;8857611
61507270314;0820201 Kultuurimaja Rugodiv T;8863414
61708300122;0820201 Kultuurimaja Rugodiv T;8866110
61610100080;0820201 Kultuurimaja Rugodiv T;8871215
61304300011;0820201 Kultuurimaja Rugodiv T;8871419
61709200017;0820201 Kultuurimaja Rugodiv T;8871613
60511303714;0951005 Narva Laste Loomemaja T;8900018
51303220090;0951005 Narva Laste Loomemaja T;8900047
51208173719;0951005 Narva Laste Loomemaja T;8900050
61209013710;0951005 Narva Laste Loomemaja T;8900131
49302243725;0951005 Narva Laste Loomemaja T;8900254
49205033733;0951005 Narva Laste Loomemaja T;8900322
61201263728;0951005 Narva Laste Loomemaja T;8900429
60510233724;0951005 Narva Laste Loomemaja T;8900458
60809203713;0951005 Narva Laste Loomemaja T;8900539
61212260114;0951005 Narva Laste Loomemaja T;8900584
46204140076;0951005 Narva Laste Loomemaja T;8900607
60106107024;0951005 Narva Laste Loomemaja T;8900610
60712103724;0951005 Narva Laste Loomemaja T;8900649
61006213723;0951005 Narva Laste Loomemaja T;8900665
61007143710;0951005 Narva Laste Loomemaja T;8900678
61305070210;0951005 Narva Laste Loomemaja T;8900681
60112043728;0951005 Narva Laste Loomemaja T;8900720
50211053721;0951005 Narva Laste Loomemaja T;8900843
60403023735;0951005 Narva Laste Loomemaja T;8900885
60510083725;0951005 Narva Laste Loomemaja T;8900924
60403133715;0951005 Narva Laste Loomemaja T;8900940
60401233711;0951005 Narva Laste Loomemaja T;8901046
61612210037;0951005 Narva Laste Loomemaja T;8901101
60903173725;0951005 Narva Laste Loomemaja T;8901127
61110293723;0951005 Narva Laste Loomemaja T;8901237
51302130064;0951005 Narva Laste Loomemaja T;8901305
61506060062;0951005 Narva Laste Loomemaja T;8901392
61602100118;0951005 Narva Laste Loomemaja T;8901431
60607263746;0951005 Narva Laste Loomemaja T;8901509
61703290130;0951005 Narva Laste Loomemaja T;8901525
61407070180;0951005 Narva Laste Loomemaja T;8901567
61402250120;0951005 Narva Laste Loomemaja T;8901570
61407160168;0951005 Narva Laste Loomemaja T;8901897
61311050083;0951005 Narva Laste Loomemaja T;8901907
51408220150;0951005 Narva Laste Loomemaja T;8901936
61407070180;0951005 Narva Laste Loomemaja T;8901965
61411220153;0951005 Narva Laste Loomemaja T;8901981
61406060102;0951005 Narva Laste Loomemaja T;8902016
61207173748;0951005 Narva Laste Loomemaja T;8902061
60709027076;0951005 Narva Laste Loomemaja T;8902139
61311190073;0951005 Narva Laste Loomemaja T;8902304
61309290136;0951005 Narva Laste Loomemaja T;8902618
60711073740;0951005 Narva Laste Loomemaja T;8902647
60809303726;0951005 Narva Laste Loomemaja T;8902650
61408020139;0951005 Narva Laste Loomemaja T;8903950
60910073719;0951005 Narva Laste Loomemaja T;8903976
51303040092;0951005 Narva Laste Loomemaja T;8903992
61003023736;0951005 Narva Laste Loomemaja T;8904014
61107233723;0951005 Narva Laste Loomemaja T;8904056
61002093714;0951005 Narva Laste Loomemaja T;8904108
51605020184;0951005 Narva Laste Loomemaja T;8904577
61301230077;0951005 Narva Laste Loomemaja T;8905453
61108303713;0951005 Narva Laste Loomemaja T;8912705
61102072739;0951005 Narva Laste Loomemaja T;8915582
61301210063;0951005 Narva Laste Loomemaja T;8917441
61006213723;0951005 Narva Laste Loomemaja T;8917483
61005243728;0951005 Narva Laste Loomemaja T;8917535
60907013721;0951005 Narva Laste Loomemaja T;8925242
61007130037;0951005 Narva Laste Loomemaja T;8925297
61202023715;0951005 Narva Laste Loomemaja T;8925352
60608153727;0951005 Narva Laste Loomemaja T;8931281
49805093712;0951005 Narva Laste Loomemaja T;8931304
60602133716;0951005 Narva Laste Loomemaja T;8936558
60402283740;0951005 Narva Laste Loomemaja T;8938051
61002033727;0951005 Narva Laste Loomemaja T;8938077
61504160243;0951005 Narva Laste Loomemaja T;8938080
60311023715;0951005 Narva Laste Loomemaja T;8938789
60909253714;0951005 Narva Laste Loomemaja T;8938828
61209013710;0951005 Narva Laste Loomemaja T;8946153
61205133732;0951005 Narva Laste Loomemaja T;8946179
61201213715;0951005 Narva Laste Loomemaja T;8946182
61306270195;0951005 Narva Laste Loomemaja T;8946315
61409270082;0951005 Narva Laste Loomemaja T;8946360
61212220196;0951005 Narva Laste Loomemaja T;8946920
61407160277;0951005 Narva Laste Loomemaja T;8946933
60601210026;0951005 Narva Laste Loomemaja T;8946991
60901290047;0951005 Narva Laste Loomemaja T;8947055
60908163710;0951005 Narva Laste Loomemaja T;8947097
61308220039;0951005 Narva Laste Loomemaja T;8950259
61405050265;0951005 Narva Laste Loomemaja T;8950262
60903183754;0951005 Narva Laste Loomemaja T;8951588
60904203720;0951005 Narva Laste Loomemaja T;8953625
60612203738;0951005 Narva Laste Loomemaja T;8954352
61209013710;0951005 Narva Laste Loomemaja T;8955526
61201263728;0951005 Narva Laste Loomemaja T;8955898
61110190138;0951005 Narva Laste Loomemaja T;8955911
51606030032;0951005 Narva Laste Loomemaja T;8955924
61412300183;0951005 Narva Laste Loomemaja T;8958468
61504160243;0951005 Narva Laste Loomemaja T;8958484
61508220132;0951005 Narva Laste Loomemaja T;8958714
61209103720;0951005 Narva Laste Loomemaja T;8960045
51412260076;0951005 Narva Laste Loomemaja T;8960058
60703053710;0951005 Narva Laste Loomemaja T;8960090
51609070130;0951005 Narva Laste Loomemaja T;8960100
61401030100;0951005 Narva Laste Loomemaja T;8960197
61311300142;0951005 Narva Laste Loomemaja T;8961358
51209043728;0951005 Narva Laste Loomemaja T;8962195
60412243727;0951005 Narva Laste Loomemaja T;8962221
50807067026;0951005 Narva Laste Loomemaja T;8962276
51611010226;0951005 Narva Laste Loomemaja T;8962289
60403023735;0951005 Narva Laste Loomemaja T;8962357
60611293730;0951005 Narva Laste Loomemaja T;8963369
61206043727;0951005 Narva Laste Loomemaja T;8963437
61603280185;0951005 Narva Laste Loomemaja T;8963440
50705017026;0951005 Narva Laste Loomemaja T;8963466
60809033739;0951005 Narva Laste Loomemaja T;8963712
60707263716;0951005 Narva Laste Loomemaja T;8964999
51407160069;0951005 Narva Laste Loomemaja T;8965040
51607150199;0951005 Narva Laste Loomemaja T;8965053
60808033713;0951005 Narva Laste Loomemaja T;8965079
60704223717;0951005 Narva Laste Loomemaja T;8965257
60905113737;0951005 Narva Laste Loomemaja T;8965273
50510273729;0951005 Narva Laste Loomemaja T;8965655
60512143724;0951005 Narva Laste Loomemaja T;8965707
61510200017;0951005 Narva Laste Loomemaja T;8965710
50701273714;0951005 Narva Laste Loomemaja T;8965859
60306223737;0951005 Narva Laste Loomemaja T;8967019
50303313731;0951005 Narva Laste Loomemaja T;8967873
61503020030;0951005 Narva Laste Loomemaja T;8970307
61410010151;0951005 Narva Laste Loomemaja T;8970608
50708023713;0951005 Narva Laste Loomemaja T;8970954
51510200038;0951005 Narva Laste Loomemaja T;8970967
61409030031;0951005 Narva Laste Loomemaja T;8971005
61307270036;0951005 Narva Laste Loomemaja T;8971063
61008053716;0951005 Narva Laste Loomemaja T;8971377
60707103712;0951005 Narva Laste Loomemaja T;8971490
60404103710;0951005 Narva Laste Loomemaja T;8971597
60812153718;0951005 Narva Laste Loomemaja T;8971872
51111133712;0951005 Narva Laste Loomemaja T;8971898
50903093732;0951005 Narva Laste Loomemaja T;8972185
51107153726;0951005 Narva Laste Loomemaja T;8972431
61209103720;0951005 Narva Laste Loomemaja T;8972460
60511223711;0951005 Narva Laste Loomemaja T;8972499
61501290179;0951005 Narva Laste Loomemaja T;8972512
60901193729;0951005 Narva Laste Loomemaja T;8972680
60909042715;0951005 Narva Laste Loomemaja T;8973634
61111073713;0951005 Narva Laste Loomemaja T;8974183
49907203718;0951005 Narva Laste Loomemaja T;8974442
61512090110;0951005 Narva Laste Loomemaja T;8974455
61110210045;0951005 Narva Laste Loomemaja T;8974701
61203123715;0951005 Narva Laste Loomemaja T;8974837
61306170025;0951005 Narva Laste Loomemaja T;8975111
61007143710;0951005 Narva Laste Loomemaja T;8975137
60508073721;0951005 Narva Laste Loomemaja T;8975690
51403240074;0951005 Narva Laste Loomemaja T;8976107
50305293736;0951005 Narva Laste Loomemaja T;8976275
60302203725;0951005 Narva Laste Loomemaja T;8976356
60012263729;0951005 Narva Laste Loomemaja T;8976903
61606270225;0951005 Narva Laste Loomemaja T;8976916
50301073723;0951005 Narva Laste Loomemaja T;8976932
60302120884;0951005 Narva Laste Loomemaja T;8977290
60311073717;0951005 Narva Laste Loomemaja T;8977973
60612073718;0951005 Narva Laste Loomemaja T;8978134
61607030147;0951005 Narva Laste Loomemaja T;8978147
50308133747;0951005 Narva Laste Loomemaja T;8978163
50311043717;0951005 Narva Laste Loomemaja T;8978202
60402182737;0951005 Narva Laste Loomemaja T;8978383
60405303716;0951005 Narva Laste Loomemaja T;8981707
60408303720;0951005 Narva Laste Loomemaja T;8982175
61104143720;0951005 Narva Laste Loomemaja T;8982272
61601280175;0951005 Narva Laste Loomemaja T;8982285
60404103710;0951005 Narva Laste Loomemaja T;8982311
60312113725;0951005 Narva Laste Loomemaja T;8982382
60401253714;0951005 Narva Laste Loomemaja T;8983721
60406223740;0951005 Narva Laste Loomemaja T;8984115
50408013722;0951005 Narva Laste Loomemaja T;8984788
61307160187;0951005 Narva Laste Loomemaja T;8984843
60901183722;0951005 Narva Laste Loomemaja T;8984898
51703040016;0951005 Narva Laste Loomemaja T;8984908
60404290014;0951005 Narva Laste Loomemaja T;8984937
50510143724;0951005 Narva Laste Loomemaja T;8985237
60403023735;0951005 Narva Laste Loomemaja T;8985392
50412013715;0951005 Narva Laste Loomemaja T;8985538
60602080307;0951005 Narva Laste Loomemaja T;8986184
60403023713;0951005 Narva Laste Loomemaja T;8986579
50308133747;0951005 Narva Laste Loomemaja T;8986689
61410200036;0951005 Narva Laste Loomemaja T;8986715
61612200052;0951005 Narva Laste Loomemaja T;8986728
60302203725;0951005 Narva Laste Loomemaja T;8986786
60302120884;0951005 Narva Laste Loomemaja T;8986841
50510143724;0951005 Narva Laste Loomemaja T;8987358
50804093723;0951005 Narva Laste Loomemaja T;8987374
60707047058;0951005 Narva Laste Loomemaja T;8987549
50610093756;0951005 Narva Laste Loomemaja T;8987730
50504293715;0951005 Narva Laste Loomemaja T;8988056
60301143731;0951005 Narva Laste Loomemaja T;8988085
60212080016;0951005 Narva Laste Loomemaja T;8988166
61104143720;0951005 Narva Laste Loomemaja T;8988292
61609150100;0951005 Narva Laste Loomemaja T;8988302
50311043717;0951005 Narva Laste Loomemaja T;8988629
50303073711;0951005 Narva Laste Loomemaja T;8988645
50307022754;0951005 Narva Laste Loomemaja T;8988726
50305293736;0951005 Narva Laste Loomemaja T;8988771
50306053734;0951005 Narva Laste Loomemaja T;8988807
61409020068;0951005 Narva Laste Loomemaja T;8988865
50301073723;0951005 Narva Laste Loomemaja T;8988881
50303263738;0951005 Narva Laste Loomemaja T;8989398
60311073739;0951005 Narva Laste Loomemaja T;8989424
60301293728;0951005 Narva Laste Loomemaja T;8990057
60212013743;0951005 Narva Laste Loomemaja T;8990442
61108203718;0951005 Narva Laste Loomemaja T;8990646
51710240181;0951005 Narva Laste Loomemaja T;8990659
60303283764;0951005 Narva Laste Loomemaja T;8990688
50404083737;0951005 Narva Laste Loomemaja T;8990701
60306113713;0951005 Narva Laste Loomemaja T;8990727
60302120884;0951005 Narva Laste Loomemaja T;8990866
60303203741;0951005 Narva Laste Loomemaja T;8990992
61208233718;0951005 Narva Laste Loomemaja T;8991250
51707150056;0951005 Narva Laste Loomemaja T;8991263
50305023719;0951005 Narva Laste Loomemaja T;8991386
50306303728;0951005 Narva Laste Loomemaja T;8991467
61305190012;0951005 Narva Laste Loomemaja T;8991535
61211073716;0951005 Narva Laste Loomemaja T;8991661
61303080099;0951005 Narva Laste Loomemaja T;8992136
61212033715;0951005 Narva Laste Loomemaja T;8992217
61303200207;0951005 Narva Laste Loomemaja T;8992246
51309050074;0951005 Narva Laste Loomemaja T;8992288
61305200076;0951005 Narva Laste Loomemaja T;8992534
51305090016;0951005 Narva Laste Loomemaja T;8992589
61310290030;0951005 Narva Laste Loomemaja T;8992738
61602120187;0951005 Narva Laste Loomemaja T;8992741
61308220039;0951005 Narva Laste Loomemaja T;8992770
51412050122;0951005 Narva Laste Loomemaja T;8992893
61507080102;0951005 Narva Laste Loomemaja T;8992958
61801270076;0951005 Narva Laste Loomemaja T;8992961
61301110220;0951005 Narva Laste Loomemaja T;8993012
61306170025;0951005 Narva Laste Loomemaja T;8993290
51304300021;0951005 Narva Laste Loomemaja T;8993481
61310040173;0951005 Narva Laste Loomemaja T;8993546
51310190187;0951005 Narva Laste Loomemaja T;8993698
61204073716;0951005 Narva Laste Loomemaja T;8993766
51804260170;0951005 Narva Laste Loomemaja T;8993779
45501213730;0951005 Narva Laste Loomemaja T;8993863
45109022211;0951005 Narva Laste Loomemaja T;8993889
45001143730;0951005 Narva Laste Loomemaja T;8994286
60703043714;0951005 Narva Laste Loomemaja T;8994626
60606283722;0951005 Narva Laste Loomemaja T;8994817
60605223719;0951005 Narva Laste Loomemaja T;8995049
61002087020;0951005 Narva Laste Loomemaja T;8995078
60601143729;0951005 Narva Laste Loomemaja T;8995120
61010050076;0951005 Narva Laste Loomemaja T;8995146
60802250010;0951005 Narva Laste Loomemaja T;8995269
60809103725;0951005 Narva Laste Loomemaja T;8995285
60904073735;0951005 Narva Laste Loomemaja T;8995340
60607113716;0951005 Narva Laste Loomemaja T;8995379
61304170188;0951005 Narva Laste Loomemaja T;8995638
61201113720;0951005 Narva Laste Loomemaja T;8995683
51108313724;0951005 Narva Laste Loomemaja T;8995764
61603240211;0951005 Narva Laste Loomemaja T;8996064
61602250148;0951005 Narva Laste Loomemaja T;8996103
61706280094;0951005 Narva Laste Loomemaja T;8996116
61610110032;0951005 Narva Laste Loomemaja T;8996132
51310180016;0951005 Narva Laste Loomemaja T;8996336
61002057065;0951005 Narva Laste Loomemaja T;8996378
61002060049;0951005 Narva Laste Loomemaja T;8996860
61610110196;0951005 Narva Laste Loomemaja T;8996909
61610070122;0951005 Narva Laste Loomemaja T;8996912
61503200192;0951005 Narva Laste Loomemaja T;8996967
61605080074;0951005 Narva Laste Loomemaja T;8997157
61612010123;0951005 Narva Laste Loomemaja T;8997209
60805083744;0951005 Narva Laste Loomemaja T;8997416
60910153711;0951005 Narva Laste Loomemaja T;8998114
61908270233;0911012 Narva Lasteaed Kaseke T;9120075
62004240124;0911012 Narva Lasteaed Kaseke T;9120127
51909150098;0911012 Narva Lasteaed Kaseke T;9120172
62001280061;0911012 Narva Lasteaed Kaseke T;9120198
52009190188;0911012 Narva Lasteaed Kaseke T;9120208
52009170010;0911012 Narva Lasteaed Kaseke T;9120240
92308201799;0911027 Narva Lasteaed Pongerjas T;9277135
52001270064;0911034 Narva Lasteaed Kirsike T;9349995
61603200227;0911036 Narva Lasteaed Vikerkaar T;9366554
$$, '\n') AS l) t;
*/
DROP FUNCTION IF EXISTS lapsed.lisa_vn();

CREATE FUNCTION lapsed.lisa_vn()
    RETURNS INTEGER
    LANGUAGE plpgsql
AS
$$
DECLARE
    v_vn      RECORD;
    l_count   INTEGER = 0;
    l_rekv_id INTEGER;
    l_kokku   INTEGER = 0;
    l_vn      TEXT;
    l_ik      TEXT;
    l_id      INTEGER;
BEGIN
    --    этим детям надо добавить приведенные ВН (если какой-то ВН у них уже есть) или назначить вновь приведенный ВН (если ВН у них нет)
    FOR v_vn IN
        SELECT replace(vn, E'\n', '')                                    AS vn1,
               regexp_replace(vn, E'(^[\\n\\r]+)|([\\n\\r]+$)', '', 'g') AS vn,
               ik,
               asutus
        FROM tmp_viitenr_lisa
        WHERE vn IS NOT NULL
        LOOP
            l_rekv_id = (SELECT id FROM ou.rekv WHERE left(nimetus, 10) = left(v_vn.asutus, 10) LIMIT 1);

            IF l_rekv_id IS NULL
            THEN
                RAISE EXCEPTION 'Puudub l_rekv_id %', v_vn;
            END IF;
            RAISE NOTICE 'lisan  l_rekv_id %,  %', l_rekv_id, v_vn;

            IF NOT exists(SELECT id
                          FROM lapsed.viitenr
                          WHERE isikukood = v_vn.ik
                            AND rekv_id = l_rekv_id
                            AND viitenumber = v_vn.vn)
            THEN
                INSERT INTO lapsed.viitenr (isikukood, rekv_id, viitenumber)
                VALUES (v_vn.ik, l_rekv_id, v_vn.vn);
                l_count = l_count + 1;
            END IF;

        END LOOP;
    RETURN l_count;

END;
$$;

SELECT lapsed.lisa_vn();

DROP FUNCTION IF EXISTS lapsed.lisa_vn();

/*
 select trim(replace(vn,E'\n',''),'"'), vn, ik, asutus from tmp_viitenr_kustuta

SELECT id FROM ou.rekv WHERE left(nimetus, 10) = left(trim('"0911027 Narva Lasteaed Pongerjas T"','"'), 10) LIMIT 1

          FROM lapsed.viitenr
            WHERE isikukood = v_vn.ik
              AND rekv_id = l_rekv_id
              AND viitenumber = trim(replace(v_vn.vn,E'\n',''),'"');

select * from tmp_viitenr_kustuta
 where vn = '9366554'

 */
