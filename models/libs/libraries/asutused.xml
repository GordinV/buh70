<?xml version = "1.0" encoding="Windows-1252" standalone="yes"?>
<VFPData>
  <selectAsLibs>
    <sql>select * from com_asutused a 
        where libs.check_asutus(a.id, $1) 
        and (kehtivus is null or kehtivus &gt; date())</sql>
    <alias>selectAsLibs</alias>
  </selectAsLibs>
  <select>
    <sql>select *, $2::integer as userid, 'ASUTUSED' as doc_type_id,
                (properties-&gt;&gt;'pank')::text as pank,
                (properties-&gt;&gt;'kmkr')::text as kmkr,
                (properties-&gt;&gt;'kehtivus')::date as kehtivus                
                from libs.asutus where id = $1</sql>
    <sqlAsNew>select $1::integer as id , $2::integer as userid, 'ASUTUSED' as doc_type_id,
            null::text as  regkood,
            null::text as nimetus,
            null::text as omvorm,
            null::text as aadress,
            null::text as kontakt,
            null::text as tel,
            null::text as faks,
            null::text as email,
            null::text as muud,
            null::text as tp,
            0::integer as staatus,
            null::text as pank,
            null::text as kmkr,
            null::text as mark</sqlAsNew>
    <query />
    <multiple>false</multiple>
    <alias>row</alias>
  </select>
  <saveDoc>
    <sql>select libs.sp_salvesta_asutus($1, $2, $3) as id</sql>
    <alias>saveDoc</alias>
  </saveDoc>
  <deleteDoc>
    <sql>select error_code, result, error_message from libs.sp_delete_asutus($1, $2)</sql>
    <alias>deleteDoc</alias>
  </deleteDoc>
  <grid>
    <sql>select a.*, $2::integer as userId
            from cur_asutused a
            where libs.check_asutus(a.id, $1)</sql>
    <alias>curAsutused</alias>
  </grid>
  <requiredFields>
    <validate>regkood,nimetus,omvorm</validate>
  </requiredFields>
</VFPData>
